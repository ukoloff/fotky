# fotky

Просмотр галерей (фотоальбомов)
[fotki.yandex.ru](http://fotki.yandex.ru/)'s и/или
[picasaweb.google.com](https://picasaweb.google.com)
на любом сайте. Использует только Javascript и JSONP для доступа к API
вышеизложенных сайтов.

## Про Google

Встраивание альбомов Google Picasa временно приостановлено,
так как похоже Google не даёт всей необходимой информации через свой API.
По крайней мере в тех же объёмах, что Yandex.

Таким образом, на данный момент можно встраивать только альбомы Яндекс Фоток.

## Встраивание

``` html
<head>
  <link rel='STYLESHEET' type='text/css' href='fotky.css'>
  <script src='fotky.js'></script>
</head>
<body>
...
<div id='fotky'>
  <div class='info'>
    Пожалуйста, подождите загрузки данных
  </div>
  <script type='text/fotky'>
    stanislav-ukolov@y 422729 * 322233
  </script>
</div>
...
</body>
```

1. Подключить [fotky.js](/fotky.js)
1. Подключить [fotky.css](/test/fotky.css)
1. Создать `<div>` с id=`fotky`
1. Добавить в этот `<div>` тэг `<script>` со списком альбомов
1. Открыть страницу в браузере!

## Указание альбомов

Список отображаемых альбомов берётся из тега `<script>` внутри основного `<div>`.
Чтобы браузер не попытался самостоятельно исполнить этот текст, рекомендуется задать
какой-нибудь type, как показано выше.

Внутри тега `<script>` указывается один или несколько пользователей
и для каждого - один или несколько номеров альбомов.

Пользователь указывается с доменом. Для пользователя Яндекса можно указать любой из доменов
@y, @yandex, @ya.ru или @yandex.ru на выбор. Пользователя Гугл можно указать с доменом
@g, @google, @gmail, @google.com или @gmail.com
(похоже, вместо имени пользователя Гугл можно также указывать его целочисленный id).

Пользователи, имеющие неизвестный домен, а также пользователи, которые не будут
найдены при обращении к Яндексу (или Гуглу) будут молча проигнорированы
(даже если это вызвано сбоем обращения к серверу, а реально такой пользователь есть).

При указании номеров альбомов может использоваться немного _магии_ в виде `*`.
Первая звёздочка в списке добавляет все альбомы текущего пользователя
(кроме тех, что уже и так добавлены). Указанные после неё номера альбомов будут
удаляться из списка добавленных ранее. Если указать ещё одну звёздочку, то после неё
альбомы снова добавляются в список. То есть например в записи
`vasya@yandex 22 33 * 44 55 * 55` сначала будут показаны альбомы 22 и 33,
в конце будет стоять альбом 55, а между ними - все остальные альбомы пользователя
vasya@yandex, кроме альбома 44.

Звёздочки можно добавлять и дальше (после второй), но вряд ли это имеет какой-то смысл.

В итоговый список войдут только общедоступные альбомы пользователя (видимые всем).
Если доступ к альбому каким-либо образом ограничен (группе пользователей или паролем),
такой альбом не будет показан. Также, если в списке указаны несуществующие номера альбомов,
они тоже тихо проигнорируются.

## Размеры альбомов

Яндекс отдаёт целиком содержимое альбома только если в нём не более 100 фоток.
Большие альбомы отдаются страницами (не более 100 фоток на страницу).

Постраничная загрузка реализована и работает. Тем не менее, рекомендуется показывать
только альбомы не более указанного выше размера.

## Постоянные ссылки

При перемещении по альбомам и фотографиям, библиотека модифицирует адрес текущей страницы,
добавляя в него код пользователя, альбома и фотографии.

Полученная таким образом ссылка является постоянной, то есть будет работать в другое время и на другой
машине. Разумеется, до тех пор, пока альбом (или фотография), на которую она ссылается не будет
удалена из списка доступных на странице или из Яндекс-Фоток (Google Picasa).

## Разработка

Для разработки используется [node.js](http://nodejs.org/), он должен быть установлен.

Установка пакетов для разработки делается командой `npm install` в корне свежеполученного репозитория.

Однократная компиляция производится командой `npm test --once`,
а команда `npm test` запускает отслеживание изменений файлов и автоматическую перкомпиляцию.

Страница, куда подключена октомпилированая (для разработки) библиотека, расположена в test/fotky.html,
её надо просто открыть в браузере.

Библиотека написана на языке [CoffeeScript](http://coffeescript.org/),
но свободно может применяться и старый добрый [JavaScript](http://ru.wikipedia.org/wiki/JavaScript).
